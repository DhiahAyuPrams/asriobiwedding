(()=>{var U=(()=>{let i=(n,l,k)=>({code:n,data:l,error:k}),r=(n=0)=>({love:n}),f=({uuid:n,own:l,name:k,presence:T,comment:A,created_at:C,is_admin:D,gif_url:H,ip:d,user_agent:o,comments:w,like:t})=>({uuid:n,own:l,name:k,presence:T,comment:A,created_at:C,is_admin:D??!1,gif_url:H,ip:d,user_agent:o,comments:w?.map(f)??[],like:r(t?.love??0)}),a=n=>n.map(f);return{uuidResponse:({uuid:n})=>({uuid:n}),baseResponse:i,tokenResponse:({token:n})=>({token:n}),statusResponse:({status:n})=>({status:n}),commentResponse:({name:n,presence:l,comment:k,is_admin:T,gif_url:A,created_at:C})=>({name:n,presence:l,comment:k,is_admin:T,gif_url:A,created_at:C}),likeCommentResponse:r,getCommentResponse:f,getCommentsResponse:a,getCommentsResponseV2:n=>({count:n.count,lists:a(n.lists)}),commentShowMore:(n,l=!1)=>({uuid:n,show:l}),postCommentRequest:(n,l,k,T,A)=>({id:n,name:l,presence:k,comment:T,gif_id:A}),postSessionRequest:(n,l)=>({email:n,password:l}),updateCommentRequest:(n,l,k)=>({presence:n,comment:l,gif_id:k})}})();var g=(()=>{let i='<span class="spinner-border spinner-border-sm my-0 ms-0 me-1 p-0" style="height: 0.8rem; width: 0.8rem;"></span>',r=m=>String(m).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),f=(m,n)=>(m.replaceChildren(document.createRange().createContextualFragment(n)),m),a=(m,n,l=.05)=>new Promise(k=>{let T=parseFloat(m.style.opacity),A=n?1:0,C=()=>{T+=n?l:-l,T=Math.max(0,Math.min(1,T)),m.style.opacity=T.toFixed(2),n&&T>=A||!n&&T<=A?(m.style.opacity=A.toString(),k(m)):requestAnimationFrame(C)};requestAnimationFrame(C)}),c=(m,n)=>{let l=null;l=setTimeout(()=>{m(),clearTimeout(l),l=null},n)};return{loader:i,copy:async(m,n=null,l=1500)=>{let k=m.getAttribute("data-copy");if(!k||k.length===0){alert("Nothing to copy");return}m.disabled=!0;try{await navigator.clipboard.writeText(k)}catch{m.disabled=!1,alert("Failed to copy");return}let T=m.innerHTML;f(m,n||'<i class="fa-solid fa-check"></i>'),c(()=>{m.disabled=!1,m.innerHTML=T},l)},timeOut:c,debounce:(m,n)=>{let l=null;return(...k)=>{clearTimeout(l),l=setTimeout(()=>m(...k),n)}},escapeHtml:r,base64Encode:m=>{let l=new TextEncoder().encode(m);return window.btoa(String.fromCharCode(...l))},base64Decode:m=>{let n=new TextDecoder,l=Uint8Array.from(window.atob(m),k=>k.charCodeAt(0));return n.decode(l)},disableButton:(m,n="Loading",l=!1)=>{m.disabled=!0;let k=m.innerHTML;return f(m,l?n:i+n),{restore:(T=!1)=>{m.innerHTML=k,m.disabled=T}}},disableCheckbox:m=>{m.disabled=!0;let n=document.querySelector(`label[for="${m.id}"]`),l=n.innerHTML;return f(n,i+l),{restore:()=>{n.innerHTML=l,m.disabled=!1}}},safeInnerHTML:f,parseUserAgent:m=>{let n=[{type:"Mobile",regex:/Android.*Mobile|iPhone|iPod|BlackBerry|IEMobile|Opera Mini/i},{type:"Tablet",regex:/iPad|Android(?!.*Mobile)|Tablet/i},{type:"Desktop",regex:/Windows NT|Macintosh|Linux/i}],l=[{name:"Chrome",regex:/Chrome|CriOS/i},{name:"Safari",regex:/Safari/i},{name:"Edge",regex:/Edg|Edge/i},{name:"Firefox",regex:/Firefox|FxiOS/i},{name:"Opera",regex:/Opera|OPR/i},{name:"Internet Explorer",regex:/MSIE|Trident/i}],k=[{name:"Windows",regex:/Windows NT ([\d.]+)/i},{name:"MacOS",regex:/Mac OS X ([\d_]+)/i},{name:"Android",regex:/Android ([\d.]+)/i},{name:"iOS",regex:/OS ([\d_]+) like Mac OS X/i},{name:"Linux",regex:/Linux/i}],T=n.find(d=>d.regex.test(m))?.type||"Unknown",A=l.find(d=>d.regex.test(m))?.name||"Unknown",C=k.find(d=>d.regex.test(m)),D=C&&m.match(C.regex)?.[1]?.replace(/_/g,".")||"",H=C?C.name:"Unknown";return D=D?`${H} ${D}`:H,`${A} ${T} ${D}`},changeOpacity:a}})();var K="GET",le="PUT",ee="POST",ce="PATCH",de="DELETE",Z=200,se=201,we=500,Q={Accept:"application/json","Content-Type":"application/json"},z=(i,r)=>{let f=new AbortController,a={signal:f.signal,method:String(i).toUpperCase(),headers:new Headers(Q)};window.addEventListener("offline",()=>f.abort()),window.addEventListener("popstate",()=>f.abort());let c=0,u=1e3,h=0,E=document.body.getAttribute("data-url");return E&&E.slice(-1)==="/"&&(E=E.slice(0,-1)),{send(s=null){return fetch(E+r,a).then(p=>p.json().then(b=>{if(p.status>=we&&(b.message??b[0]))throw new Error(b.message??b[0]);if(b.error)throw new Error(b.error[0]);return s&&(b.data=s(b.data)),U.baseResponse(b.code,b.data,b.error)})).catch(p=>{if(p.name==="AbortError")return console.warn("Fetch abort:",p),p;throw alert(p),new Error(p)})},withTimeout(s=3,p=1e3){return c=s,u=p,this},withCancel(s){return s==null?this:((async()=>(await s,f.abort()))(),this)},default(s=null){if(a.headers=new Headers(s??{}),c===0&&u===0)return fetch(r,a);let p=async()=>{try{let b=await fetch(r,a);if(!b.ok)throw new Error(`HTTP error! Status: ${b.status}`);return b}catch(b){if(b.name==="AbortError")throw b;if(u*=2,h++,h>=c)throw new Error(`Max retries reached: ${b}`);return console.warn(`Retrying fetch (${h}/${c}): ${r}`),await new Promise(y=>g.timeOut(y,u)),p()}};return p()},download(){return Object.keys(Q).forEach(s=>a.headers.delete(s)),fetch(E+r,a).then(s=>{if(s.status!==Z)return!1;let p=document.querySelector("a[download]");p&&document.body.removeChild(p);let b=s.headers.get("content-disposition")?.match(/filename="(.+)"/)?.[1]??"download.csv";return s.blob().then(y=>{let m=document.createElement("a"),n=window.URL.createObjectURL(y);return m.href=n,m.download=b,document.body.appendChild(m),m.click(),document.body.removeChild(m),window.URL.revokeObjectURL(n),!0})}).catch(s=>{if(s.name==="AbortError")return console.warn("Fetch abort:",s),s;throw alert(s),new Error(s)})},token(s){return s.split(".").length===3?(a.headers.append("Authorization","Bearer "+s),this):(a.headers.append("x-access-key",s),this)},body(s){return a.body=JSON.stringify(s),this}}};var te=i=>{let r=new Map,f=[],a=null,c=1e3*60*60*6,u=(y,m,n=null)=>{r.set(y,[...r.get(y)??[],[m,n]])},h=async()=>{!a&&window.isSecureContext&&(a=await window.caches.open(i))},E=async(y,m=null)=>{await h();let n=()=>z(K,y).withCancel(m).withTimeout().default().then(l=>l.blob().then(k=>{if(!window.isSecureContext)return k;let T=new Headers,A=new Date(Date.now()+c);return T.set("Content-Length",String(k.size)),T.set("Expires",A.toUTCString()),T.set("Content-Type",l.headers.get("Content-Type")),a.put(y,new Response(k,{headers:T})).then(()=>k)}));return window.isSecureContext?a.match(y).then(l=>{if(!l)return n();let k=l.headers.get("Expires"),T=k?new Date(k).getTime():0;return Date.now()>T?a.delete(y).then(A=>A?n():l.blob()):l.blob()}):n()};return{setTtl:y=>{c=Number(y)},run:async(y=null)=>{let m=r.size;return await h(),window.isSecureContext||console.warn("Cache is not supported in insecure context"),new Promise(n=>{r.forEach(async(l,k)=>{try{let T=await E(k,y);for(let A of l)await A[0](T);f.forEach(A=>A(k))}catch(T){for(let A of l){let C=A[1];C&&await C(T)}}finally{m--,m===0&&(f.length=0,r.clear(),n())}})})},add:u,get:E,open:h,onEachComplete:y=>{f.push(y)}}};var _=(()=>{let i=null,r=null,f=0,a=0,c=!0,u=()=>{f+=1},h=()=>`(${a}/${f}) [${parseInt(a/f*100).toFixed(0)}%]`;return{init:()=>{i=document.getElementById("progress-info"),r=document.getElementById("progress-bar"),i.style.display="block"},add:u,invalid:b=>{c&&(r.style.backgroundColor="red",i.innerText=`Error loading ${b} ${h()}`),c=!1},complete:b=>{c&&(a+=1,i.innerText=`Loading ${b} complete ${h()}`,r.style.width=Math.min(a/f*100,100).toString()+"%",a===f&&document.dispatchEvent(new Event("progress.done")))}}})();var re=(()=>{let i=null,r=!1,f=null,a=s=>{let p=new Image;p.onload=()=>{s.src=p.src,s.width=p.width,s.height=p.height,p.remove(),_.complete("image")};let b=()=>{_.invalid("image")},y=m=>{m.size>0?p.src=URL.createObjectURL(m):b()};f.add(s.getAttribute("data-src"),y,b)},c=s=>{s.onerror=()=>_.invalid("image"),s.onload=()=>{s.width=s.naturalWidth,s.height=s.naturalHeight,_.complete("image")},s.complete&&s.naturalWidth!==0&&s.naturalHeight!==0?_.complete("image"):s.complete&&_.invalid("image")},u=()=>r,h=()=>{for(let s of i)s.hasAttribute("data-src")?a(s):c(s);r&&f.run()};return{init:()=>(f=te("images"),i=document.querySelectorAll("img"),i.forEach(_.add),r=Array.from(i).some(s=>s.hasAttribute("data-src")),{load:h,hasDataSrc:u})}})();var ae=(()=>{let i=null,r=null,f=null,a=!1,c='<i class="fa-solid fa-circle-pause spin-button"></i>',u='<i class="fa-solid fa-circle-play"></i>',h=async()=>{if(navigator.onLine){i.disabled=!0;try{await f,await r.play(),a=!0,i.disabled=!1,i.innerHTML=c}catch(p){a=!1,alert(p)}}},E=()=>{a=!1,r.pause(),i.innerHTML=u};return{init:async()=>{i=document.getElementById("button-music"),document.addEventListener("undangan.open",()=>{i.style.display="block"});try{let p=await te("audio").get(i.getAttribute("data-url")).then(b=>URL.createObjectURL(b));r=new Audio(p),r.volume=1,r.loop=!0,r.muted=!1,r.currentTime=0,r.autoplay=!1,r.controls=!1,f=new Promise(b=>r.addEventListener("canplay",b)),_.complete("audio")}catch{_.invalid("audio")}i.addEventListener("offline",E),i.addEventListener("click",()=>a?E():h())},play:h}})();var me={tab:f=>window.bootstrap.Tab.getOrCreateInstance(document.getElementById(f)),modal:f=>window.bootstrap.Modal.getOrCreateInstance(document.getElementById(f))};var B=i=>{let r=(h=null)=>{let E=JSON.parse(localStorage.getItem(i));return h?E[String(h)]:E},f=(h,E)=>{let s=r();s[String(h)]=E,localStorage.setItem(i,JSON.stringify(s))},a=h=>Object.keys(r()).includes(String(h)),c=h=>{if(!a(h))return;let E=r();delete E[String(h)],localStorage.setItem(i,JSON.stringify(E))},u=()=>localStorage.setItem(i,"{}");return localStorage.getItem(i)||u(),{set:f,get:r,has:a,clear:u,unset:c}};var oe=(()=>{let i={"#000000":"#ffffff","#ffffff":"#000000","#212529":"#f8f9fa","#f8f9fa":"#212529"},r=["#ffffff","#f8f9fa"],f=["#000000","#212529"],a=!1,c=null,u=null,h=()=>c.set("active","light"),E=()=>c.set("active","dark"),s=T=>{let A=u.getAttribute("content");u.setAttribute("content",T.some(C=>C===A)?i[A]:A)},p=()=>{h(),document.documentElement.setAttribute("data-bs-theme","light"),s(f)},b=()=>{E(),document.documentElement.setAttribute("data-bs-theme","dark"),s(r)},y=(T=null,A=null)=>{let C=c.get("active")==="dark";return T&&A?C?T:A:C};return{init:()=>{switch(c=B("theme"),u=document.querySelector('meta[name="theme-color"]'),c.has("active")||(window.matchMedia("(prefers-color-scheme: dark)").matches?E():h()),document.documentElement.getAttribute("data-bs-theme")){case"dark":E();break;case"light":h();break;default:a=!0}y()?b():p()},spyTop:()=>{let T=C=>C.filter(D=>D.isIntersecting).forEach(D=>{let H=D.target.classList.contains("bg-white-black")?y(f[0],r[0]):y(f[1],r[1]);u.setAttribute("content",H)}),A=new IntersectionObserver(T,{rootMargin:"0% 0% -95% 0%"});document.querySelectorAll("section").forEach(C=>A.observe(C))},change:()=>y()?p():b(),isDarkMode:y,isAutoMode:()=>a}})();var W=(()=>{let i={id:"ID",en:"US",fr:"FR",de:"DE",es:"ES",zh:"CN",ja:"JP",ko:"KR",ar:"SA",ru:"RU",it:"IT",nl:"NL",pt:"PT",tr:"TR",th:"TH",vi:"VN",ms:"MY",hi:"IN"},r=null,f=null,a=null,c=null;return{on(u,h){return c.set(u,h),this},get(){let u=c.get(a);return c.clear(),u},getCountry(){return r},getLocale(){return f},getLanguage(){return a},setDefault(u){let h=!0;i[u]||(h=!1,console.warn("Language not found, please add manually in countryMapping")),r=h?i[u]:"US",a=h?u:"en",f=`${a}_${r}`},init(){c=new Map,this.setDefault(navigator.language.split("-").shift())}}})();var P=(()=>{let i=null,r=()=>i.get("token"),f=p=>i.set("token",p),a=p=>z(ee,"/api/session").body(p).send(U.tokenResponse).then(b=>(b.code===Z&&f(b.data.token),b.code===Z),()=>!1),c=()=>i.unset("token"),u=()=>String(r()??".").split(".").length===3;return{init:()=>{i=B("session")},guest:()=>z(K,"/api/config").token(r()).send().then(p=>{if(p.code!==Z)throw new Error("failed to get config.");let b=B("config");for(let[y,m]of Object.entries(p.data))b.set(y,m);return p}),login:a,logout:c,decode:()=>{if(!u())return null;try{return JSON.parse(g.base64Decode(r().split(".")[1]))}catch{return null}},isAdmin:u,setToken:f,getToken:r}})();var ue=(()=>{let i=null,r=!0,f=["input[data-offline-disabled]","button[data-offline-disabled]","select[data-offline-disabled]","textarea[data-offline-disabled]"],a=()=>r,c=()=>{let y=i.firstElementChild.firstElementChild;y.classList.remove("bg-success"),y.classList.add("bg-danger"),y.firstElementChild.innerHTML='<i class="fa-solid fa-ban me-2"></i>Koneksi tidak tersedia'},u=()=>{let y=i.firstElementChild.firstElementChild;y.classList.remove("bg-danger"),y.classList.add("bg-success"),y.firstElementChild.innerHTML='<i class="fa-solid fa-cloud me-2"></i>Koneksi tersedia kembali'},h=async()=>{r&&(await g.changeOpacity(i,!1),c())},E=()=>{document.querySelectorAll(f.join(", ")).forEach(y=>{y.dispatchEvent(new Event(a()?"online":"offline")),y.setAttribute("data-offline-disabled",a()?"false":"true"),y.tagName==="BUTTON"?a()?y.classList.remove("disabled"):y.classList.add("disabled"):a()?y.removeAttribute("disabled"):y.setAttribute("disabled","true")})},s=()=>{r=!1,c(),g.changeOpacity(i,!0),E()},p=()=>{r=!0,u(),g.timeOut(h,3e3),E()};return{init:()=>{window.addEventListener("online",p),window.addEventListener("offline",s),i=document.getElementById("offline-mode"),i.innerHTML=`
        <div class="d-flex justify-content-center mx-auto">
            <div class="d-flex justify-content-center align-items-center rounded-pill my-2 bg-danger shadow">
                <small class="text-center py-1 px-2 mx-1 mt-1 mb-0 text-white" style="font-size: 0.8rem;"></small>
            </div>
        </div>`},isOnline:a}})();var M=(()=>{let i="gifs",r="default",f={128:2,256:3,512:4,768:5},a=null,c=null,u=null,h=null,E=null,s=(e,$)=>{let{id:x,media_formats:{tinygif:{url:S}},content_description:q}=$;e.pointer===-1||e.pointer===e.col-1?e.pointer=0:e.pointer++;let O=0;for(let j of e.lists.childNodes){if(O===e.pointer){c.add(S,ne=>{let G=URL.createObjectURL(ne);a.set(S,G),j.insertAdjacentHTML("beforeend",`
                    <figure class="gif-figure m-0 position-relative">
                        <button onclick="undangan.comment.gif.click('${e.uuid}', '${x}', '${g.base64Encode(S)}')" class="btn gif-checklist position-absolute justify-content-center align-items-center top-0 end-0 bg-overlay-auto p-1 m-1 rounded-circle border shadow-sm z-1">
                            <i class="fa-solid fa-circle-check"></i>
                        </button>
                        <img src="${G}" class="img-fluid" alt="${g.escapeHtml(q)}" style="width: 100%;">
                    </figure>`)});return}O++}},p=async()=>{await c.open()},b=async e=>(a.has(e)||a.set(e,URL.createObjectURL(await c.get(e))),a.get(e)),y=e=>{let $=e.lists,x=document.getElementById(`gif-loading-${e.uuid}`),S=document.getElementById(`progress-bar-${e.uuid}`),q=document.getElementById(`progress-info-${e.uuid}`),O=0,j=0;return $.classList.contains("d-none")||x.classList.replace("d-none","d-flex"),q.innerText=`${j}/${O}`,$.setAttribute("data-continue","false"),$.classList.replace("overflow-y-scroll","overflow-y-hidden"),{release:()=>{$.classList.contains("d-none")||x.classList.replace("d-flex","d-none"),S.style.width="0%",q.innerText=`${j}/${O}`,$.setAttribute("data-continue","true"),$.classList.replace("overflow-y-hidden","overflow-y-scroll")},until:ye=>{O=ye,q.innerText=`${j}/${O}`},step:()=>{j+=1,q.innerText=`${j}/${O}`,S.style.width=Math.min(j/O*100,100).toString()+"%"}}},m=(e,$,x)=>{x={media_filter:"tinygif",client_key:"undangan_app",key:E.get("tenor_key"),country:W.getCountry(),locale:W.getLocale(),...x??{}};let S=Object.keys(x).filter(O=>x[O]!==null&&x[O]!==void 0).map(O=>`${O}=${encodeURIComponent(x[O])}`).join("&"),q=`https://tenor.googleapis.com/v2${$}?${S}`;e.last=new Promise(O=>{let j=y(e),ne=new Promise(G=>{e.reqs.push(G)});(async()=>{try{let G=await z(K,q).withCancel(ne).default(Q).then(Y=>Y.json()).then(Y=>{if(!Y.error)return Y;throw new Error(Y.error.message)});if(G.results.length>0){e.next=G?.next,j.until(G.results.length),c.onEachComplete(j.step);for(let Y of G.results)e.gifs.push(Y),s(e,Y);await c.run(ne)}}catch(G){G.name==="AbortError"?console.warn("Fetch abort:",G):alert(G)}finally{j.release(),O()}})()})},n=e=>(e=g.escapeHtml(e),`
        <label for="gif-search-${e}" class="form-label my-1"><i class="fa-solid fa-photo-film me-2"></i>Gif</label>

        <div class="d-flex mb-3" id="gif-search-nav-${e}">
            <button class="btn btn-secondary btn-sm rounded-4 shadow-sm me-1 my-1" onclick="undangan.comment.gif.back(this, '${e}')" data-offline-disabled="false"><i class="fa-solid fa-arrow-left"></i></button>
            <input type="text" name="gif-search" id="gif-search-${e}" autocomplete="on" class="form-control shadow-sm rounded-4" placeholder="Search for a GIF on Tenor" data-offline-disabled="false">
        </div>

        <div class="position-relative">
            <div class="position-absolute d-flex flex-column justify-content-center align-items-center top-50 start-50 translate-middle w-100 h-100 bg-overlay-auto rounded-4 z-3" id="gif-loading-${e}">
                <div class="progress w-25" role="progressbar" style="height: 0.5rem;" aria-label="progress bar">
                    <div class="progress-bar" id="progress-bar-${e}" style="width: 0%"></div>
                </div>
                <small class="mt-1 text-theme-auto bg-theme-auto py-0 px-2 rounded-4" id="progress-info-${e}" style="font-size: 0.7rem;"></small>
            </div>
            <div id="gif-lists-${e}" class="d-flex rounded-4 p-0 overflow-y-scroll border" data-continue="true" style="height: 15rem;"></div>
        </div>

        <figure class="d-flex m-0 position-relative" id="gif-result-${e}">
            <button onclick="undangan.comment.gif.cancel('${e}')" id="gif-cancel-${e}" class="btn d-none position-absolute justify-content-center align-items-center top-0 end-0 bg-overlay-auto p-2 m-1 rounded-circle border shadow-sm z-1">
                <i class="fa-solid fa-circle-xmark"></i>
            </button>
        </figure>`),l=async e=>{e.reqs.forEach($=>$()),e.reqs.length=0,e.last&&(await e.last,e.last=null)},k=async e=>{await l(e);let $=e.col??0,x=0;for(let[q,O]of Object.entries(f))x=O,e.lists.clientWidth>=parseInt(q)&&(e.col=x);if(e.col===null&&(e.col=x),$===e.col||(e.pointer=-1,e.limit=e.col*5,e.lists.innerHTML='<div class="d-flex flex-column"></div>'.repeat(e.col),e.gifs.length===0))return;let S=y(e);S.until(e.gifs.length),c.onEachComplete(S.step);try{e.gifs.forEach(q=>s(e,q)),await c.run()}catch{e.gifs.length=0}$!==e.col&&e.lists.scroll({top:e.lists.scrollHeight,behavior:"instant"}),S.release(),e.gifs.length===0&&await k(e)},T=async e=>{if(e.lists.getAttribute("data-continue")!=="true"||!e.next||e.next.length===0)return;let $=e.query&&e.query.trim().length>0,x={pos:e.next,limit:e.limit};$&&(x.q=e.query),e.lists.scrollTop>(e.lists.scrollHeight-e.lists.clientHeight)*.8&&(await k(e),m(e,$?"/search":"/featured",x))},A=async(e,$=null)=>{e.query=$!==null?$:e.query,(!e.query||e.query.trim().length===0)&&(e.query=null),e.col=null,e.next=null,e.pointer=-1,e.gifs.length=0,await k(e),m(e,e.query===null?"/featured":"/search",{q:e.query,limit:e.limit})},C=e=>{if(!u.has(e)){g.safeInnerHTML(document.getElementById(`gif-form-${e}`),n(e)),u.set(e,{uuid:e,last:null,limit:null,query:null,next:null,col:null,pointer:-1,gifs:[],reqs:[],lists:document.getElementById(`gif-lists-${e}`)});let $=u.get(e),x=g.debounce(A,750),S=g.debounce(T,250);$.lists.addEventListener("scroll",()=>S($)),document.getElementById(`gif-search-${e}`).addEventListener("input",q=>x($,q.target.value))}return u.get(e)};return{default:r,init:()=>{a=new Map,u=new Map,h=new Map,c=te(i),E=B("config"),E.get("tenor_key")===null&&document.querySelector('[onclick="undangan.comment.gif.open(undangan.comment.gif.default)"]')?.remove()},get:b,back:async(e,$)=>{let x=g.disableButton(e,g.loader.replace("me-1","me-0"),!0);await l(u.get($)),x.restore(),document.getElementById(`gif-form-${$}`).classList.toggle("d-none",!0),document.getElementById(`comment-form-${$}`)?.classList.toggle("d-none",!1)},open:e=>{let $=C(e);return document.getElementById(`gif-form-${e}`).classList.toggle("d-none",!1),document.getElementById(`comment-form-${e}`)?.classList.toggle("d-none",!0),h.has(e)&&h.get(e)(),A($)},cancel:e=>{let $=document.getElementById(`gif-result-${e}`);$.removeAttribute("data-id"),$.querySelector(`#gif-cancel-${e}`).classList.replace("d-flex","d-none"),$.querySelector("img").remove(),u.get(e).lists.classList.replace("d-none","d-flex"),document.getElementById(`gif-search-nav-${e}`).classList.replace("d-none","d-flex")},click:(e,$,x)=>{let S=document.getElementById(`gif-result-${e}`);S.setAttribute("data-id",$),S.querySelector(`#gif-cancel-${e}`).classList.replace("d-none","d-flex"),S.insertAdjacentHTML("beforeend",`<img src="${a.get(g.base64Decode(x))}" class="img-fluid mx-auto gif-image rounded-4" alt="selected-gif">`),u.get(e).lists.classList.replace("d-flex","d-none"),document.getElementById(`gif-search-nav-${e}`).classList.replace("d-flex","d-none")},remove:async(e=null)=>{e?u.has(e)&&(await l(u.get(e)),h.delete(e),u.delete(e)):(await Promise.all(Array.from(u.keys()).map($=>l(u.get($)))),h.clear(),u.clear())},isOpen:e=>{let $=document.getElementById(`gif-form-${e}`);return $===null?!1:!$.classList.contains("d-none")},onOpen:(e,$)=>h.set(e,$),getResultId:e=>document.getElementById(`gif-result-${e}`)?.getAttribute("data-id"),buttonCancel:(e=null)=>{let $=document.getElementById(`gif-cancel-${e||r}`);return{show:()=>$.classList.replace("d-none","d-flex"),hide:()=>$.classList.replace("d-flex","d-none"),click:()=>$.dispatchEvent(new Event("click"))}},removeGifSearch:e=>document.querySelector(`[for="gif-search-${e}"]`)?.remove(),removeButtonBack:e=>document.querySelector(`[onclick="undangan.comment.gif.back(this, '${e}')"]`)?.remove(),prepareCache:p}})();var V=(()=>{let i=null,r=null,f=null,a=null,c=null,u=null,h=300,E=[["*",'<strong class="text-theme-auto">$1</strong>'],["_",'<em class="text-theme-auto">$1</em>'],["~",'<del class="text-theme-auto">$1</del>'],["```",'<code class="font-monospace text-theme-auto">$1</code>']],s=()=>`
        <div class="bg-theme-auto shadow p-3 mx-0 mt-0 mb-3 rounded-4">
            <div class="d-flex justify-content-between align-items-center placeholder-wave">
                <span class="placeholder bg-secondary col-5 rounded-3 my-1"></span>
                <span class="placeholder bg-secondary col-3 rounded-3 my-1"></span>
            </div>
            <hr class="my-1">
            <p class="placeholder-wave m-0">
                <span class="placeholder bg-secondary col-6 rounded-3"></span>
                <span class="placeholder bg-secondary col-5 rounded-3"></span>
                <span class="placeholder bg-secondary col-12 rounded-3 my-1"></span>
            </p>
        </div>`,p=t=>(E.forEach(v=>{let L=v[0],I=v[1];t=t.replace(new RegExp(`\\${L}(?=\\S)(.*?)(?<!\\s)\\${L}`,"gs"),I)}),t),b=t=>`
        <button style="font-size: 0.8rem;" onclick="undangan.comment.like.love(this)" data-uuid="${t.uuid}" class="btn btn-sm btn-outline-auto ms-auto rounded-3 p-0 shadow-sm d-flex justify-content-start align-items-center" data-offline-disabled="false">
            <span class="my-0 mx-1" data-count-like="${t.like.love}">${t.like.love}</span>
            <i class="me-1 ${f.has(t.uuid)?"fa-solid fa-heart text-danger":"fa-regular fa-heart"}"></i>
        </button>`,y=t=>{let v=`<div class="d-flex justify-content-start align-items-center" data-button-action="${t.uuid}">`;return(a.get("can_reply")===!0||a.get("can_reply")===void 0)&&(v+=`<button style="font-size: 0.8rem;" onclick="undangan.comment.reply(this)" data-uuid="${t.uuid}" class="btn btn-sm btn-outline-auto rounded-4 py-0 me-1 shadow-sm" data-offline-disabled="false">Reply</button>`),r.has(t.uuid)&&(a.get("can_edit")===!0||a.get("can_edit")===void 0)&&!(t.gif_url&&a.get("tenor_key")===null)&&(v+=`<button style="font-size: 0.8rem;" onclick="undangan.comment.edit(this)" data-uuid="${t.uuid}" class="btn btn-sm btn-outline-auto rounded-4 py-0 me-1 shadow-sm" data-offline-disabled="false">Edit</button>`),P.isAdmin()?v+=`<button style="font-size: 0.8rem;" onclick="undangan.comment.remove(this)" data-uuid="${t.uuid}" class="btn btn-sm btn-outline-auto rounded-4 py-0 me-1 shadow-sm" data-own="${t.own}" data-offline-disabled="false">Delete</button>`:r.has(t.uuid)&&(a.get("can_delete")===!0||a.get("can_delete")===void 0)&&(v+=`<button style="font-size: 0.8rem;" onclick="undangan.comment.remove(this)" data-uuid="${t.uuid}" class="btn btn-sm btn-outline-auto rounded-4 py-0 me-1 shadow-sm" data-offline-disabled="false">Delete</button>`),v+="</div>",v},m=(t,v)=>{t=g.escapeHtml(t);let L=u.get("show").includes(t);return`<a class="text-theme-auto" style="font-size: 0.8rem;" onclick="undangan.comment.showOrHide(this)" data-uuid="${t}" data-uuids="${g.escapeHtml(v.join(","))}" data-show="${L?"true":"false"}" role="button" class="me-auto ms-1 py-0">${L?"Hide replies":`Show replies (${v.length})`}</a>`},n=t=>`
        <div class="d-flex justify-content-between align-items-center" id="button-${t.uuid}">
            ${y(t)}
            ${t.comments.length>0?m(t.uuid,t.comments.map(v=>v.uuid)):""}
            ${b(t)}
        </div>`,l=t=>t.ip===void 0||t.user_agent===void 0||t.is_admin?"":`
        <div class="mb-1 mt-3">
            <p class="text-theme-auto mb-1 mx-0 mt-0 p-0" style="font-size: 0.7rem;" id="ip-${t.uuid}"><i class="fa-solid fa-location-dot me-1"></i>${g.escapeHtml(t.ip)} ${c.has(t.ip)?`<strong>${c.get(t.ip)}</strong>`:'<span class="mb-1 placeholder col-2 rounded-3"></span>'}</p>
            <p class="text-theme-auto m-0 p-0" style="font-size: 0.7rem;"><i class="fa-solid fa-mobile-screen-button me-1"></i>${g.parseUserAgent(g.escapeHtml(t.user_agent))}</p>
        </div>`,k=(t,v)=>v?'class="bg-theme-auto shadow p-3 mx-0 mt-0 mb-3 rounded-4" data-parent="true"':`class="${u.get("hidden").find(L=>L.uuid===t.uuid).show?"":"d-none"} overflow-x-scroll mw-100 border-start bg-theme-auto py-2 ps-2 pe-0 my-2 ms-2 me-0"`,T=(t,v)=>t.is_admin?`<strong class="me-1">${g.escapeHtml(i.get("name")??a.get("name"))}</strong><i class="fa-solid fa-certificate text-primary"></i>`:v?`<strong class="me-1">${g.escapeHtml(t.name)}</strong><i id="badge-${t.uuid}" data-is-presence="${t.presence?"true":"false"}" class="fa-solid ${t.presence?"fa-circle-check text-success":"fa-circle-xmark text-danger"}"></i>`:`<strong>${g.escapeHtml(t.name)}</strong>`,A=async(t,v)=>{let L=`
        <div class="d-flex justify-content-between align-items-center">
            <p class="text-theme-auto text-truncate m-0 p-0" style="font-size: 0.95rem;">${T(t,v)}</p>
            <small class="text-theme-auto m-0 p-0" style="font-size: 0.75rem;">${t.created_at}</small>
        </div>
        <hr class="my-1">`;if(t.gif_url)return L+`
            <div class="d-flex justify-content-center align-items-center my-2">
                <img src="${await M.get(t.gif_url)}" id="img-gif-${t.uuid}" class="img-fluid mx-auto gif-image rounded-4" alt="selected-gif">
            </div>`;let I=p(g.escapeHtml(t.comment)),R=I.length>h;return L+`
        <p class="text-theme-auto my-1 mx-0 p-0" style="white-space: pre-wrap !important; font-size: 0.95rem;" ${R?`data-comment="${g.base64Encode(I)}"`:""} id="content-${t.uuid}">${R?I.slice(0,h)+"...":I}</p>
        ${R?`<p class="d-block mb-2 mt-0 mx-0 p-0"><a class="text-theme-auto" role="button" style="font-size: 0.85rem;" data-show="false" onclick="undangan.comment.showMore(this, '${t.uuid}')">Selengkapnya</a></p>`:""}`},C=async(t,v=!1)=>{let L=await A(t,v),I=await Promise.all(t.comments.map(R=>C(R)));return`
        <div ${k(t,v)} id="${t.uuid}" style="overflow-wrap: break-word !important;">
            <div id="body-content-${t.uuid}" data-tapTime="0" data-liked="false" tabindex="0">${L}</div>
            ${l(t)}
            ${n(t)}
            <div id="reply-content-${t.uuid}">${I.join("")}</div>
        </div>`};return{init:()=>{i=B("user"),r=B("owns"),f=B("likes"),a=B("config"),c=B("tracker"),u=B("comment")},renderEdit:(t,v,L,I)=>{t=g.escapeHtml(t);let R=document.createElement("div");R.classList.add("my-2"),R.id=`inner-${t}`;let N=`
        <p class="my-1 mx-0 p-0" style="font-size: 0.95rem;"><i class="fa-solid fa-pen me-2"></i>Edit</p>
        ${L?`
        <select class="form-select shadow-sm mb-2 rounded-4" id="form-inner-presence-${t}" data-offline-disabled="false">
            <option value="1" ${v?"selected":""}>&#9989; Datang</option>
            <option value="2" ${v?"":"selected"}>&#10060; Berhalangan</option>
        </select>`:""}
        ${I?`${a.get("tenor_key")===null?"":`<div class="d-none mb-2" id="gif-form-${t}"></div>`}`:`<textarea class="form-control shadow-sm rounded-4 mb-2" id="form-inner-${t}" minlength="1" maxlength="1000" placeholder="Type update comment" rows="3" data-offline-disabled="false"></textarea>    
        `}
        <div class="d-flex justify-content-end align-items-center mb-0">
            <button style="font-size: 0.8rem;" onclick="undangan.comment.cancel(this, '${t}')" class="btn btn-sm btn-outline-auto rounded-4 py-0 me-1" data-offline-disabled="false">Cancel</button>
            <button style="font-size: 0.8rem;" onclick="undangan.comment.update(this)" data-uuid="${t}" class="btn btn-sm btn-outline-auto rounded-4 py-0" data-offline-disabled="false">Update</button>
        </div>`;return g.safeInnerHTML(R,N)},renderReply:t=>{t=g.escapeHtml(t);let v=document.createElement("div");v.classList.add("my-2"),v.id=`inner-${t}`;let L=`
        <p class="my-1 mx-0 p-0" style="font-size: 0.95rem;"><i class="fa-solid fa-reply me-2"></i>Reply</p>
        <div class="d-block mb-2" id="comment-form-${t}">
            <div class="position-relative">
                ${a.get("tenor_key")===null?"":`<button class="btn btn-secondary btn-sm rounded-4 shadow-sm me-1 my-1 position-absolute bottom-0 end-0" onclick="undangan.comment.gif.open('${t}')" aria-label="button gif" data-offline-disabled="false"><i class="fa-solid fa-photo-film"></i></button>`}
                <textarea class="form-control shadow-sm rounded-4 mb-2" id="form-inner-${t}" minlength="1" maxlength="1000" placeholder="Type reply comment" rows="3" data-offline-disabled="false"></textarea>
            </div>
        </div>
        <div class="d-none mb-2" id="gif-form-${t}"></div>
        <div class="d-flex justify-content-end align-items-center mb-0">
            <button style="font-size: 0.8rem;" onclick="undangan.comment.cancel(this, '${t}')" class="btn btn-sm btn-outline-auto rounded-4 py-0 me-1" data-offline-disabled="false">Cancel</button>
            <button style="font-size: 0.8rem;" onclick="undangan.comment.send(this)" data-uuid="${t}" class="btn btn-sm btn-outline-auto rounded-4 py-0" data-offline-disabled="false">Send</button>
        </div>`;return g.safeInnerHTML(v,L)},renderLoading:s,renderReadMore:m,renderContentMany:t=>M.prepareCache().then(()=>Promise.all(t.map(v=>C(v,!0)))).then(v=>v.join("")),renderContentSingle:t=>M.prepareCache().then(()=>C(t)),convertMarkdownToHTML:p,maxCommentLength:h}})();var fe=()=>window.confetti.shapeFromPath({path:"M167 72c19,-38 37,-56 75,-56 42,0 76,33 76,75 0,76 -76,151 -151,227 -76,-76 -151,-151 -151,-227 0,-42 33,-75 75,-75 38,0 57,18 76,56z",matrix:[.03333333333333333,0,0,.03333333333333333,-5.566666666666666,-5.533333333333333]}),ge=()=>{window.confetti({origin:{y:1},zIndex:1057})},pe=(i=15)=>{let r=i*1e3,f=Date.now()+r,a=fe(),c=["#FFC0CB","#FF1493","#C71585"],u=(E,s)=>Math.random()*(s-E)+E,h=()=>{let E=f-Date.now();c.forEach(s=>{window.confetti({particleCount:1,startVelocity:0,ticks:Math.max(50,75*(E/r)),origin:{x:Math.random(),y:Math.abs(Math.random()-E/r)},zIndex:1057,colors:[s],shapes:[a],drift:u(-.5,.5),gravity:u(.5,1),scalar:u(.5,1)})}),E>0&&requestAnimationFrame(h)};requestAnimationFrame(h)},he=i=>{if(!window.confetti)return;let r=Date.now()+25,f=Math.max(.3,Math.min(1,i.getBoundingClientRect().top/window.innerHeight+.2)),a=fe(),c=["#FF69B4","#FF1493"],u=()=>{c.forEach(h=>{window.confetti({particleCount:2,angle:60,spread:55,shapes:[a],origin:{x:0,y:f},zIndex:1057,colors:[h]}),window.confetti({particleCount:2,angle:120,spread:55,shapes:[a],origin:{x:1,y:f},zIndex:1057,colors:[h]})}),Date.now()<r&&requestAnimationFrame(u)};requestAnimationFrame(u)};var X=(()=>{let i=null,r=null,f=async s=>{let p=s.firstElementChild,b=s.lastElementChild,y=s.getAttribute("data-uuid"),m=parseInt(p.getAttribute("data-count-like"));s.disabled=!0,navigator.vibrate&&navigator.vibrate(100),i.has(y)?await z(ce,"/api/comment/"+i.get(y)).token(P.getToken()).send(U.statusResponse).then(n=>{n.data.status&&(i.unset(y),b.classList.remove("fa-solid","text-danger"),b.classList.add("fa-regular"),p.setAttribute("data-count-like",String(m-1)))}):await z(ee,"/api/comment/"+y).token(P.getToken()).send(U.uuidResponse).then(n=>{n.code===se&&(i.set(y,n.data.uuid),b.classList.remove("fa-regular"),b.classList.add("fa-solid","text-danger"),p.setAttribute("data-count-like",String(m+1)))}),p.innerText=p.getAttribute("data-count-like"),s.disabled=!1},a=s=>document.querySelector(`button[onclick="undangan.comment.like.love(this)"][data-uuid="${s}"]`),c=async s=>{if(!navigator.onLine)return;let p=Date.now(),b=p-parseInt(s.getAttribute("data-tapTime")),y=s.id.replace("body-content-",""),m=b<300&&b>0,n=!i.has(y)&&s.getAttribute("data-liked")!=="true";m&&n&&(he(s),s.setAttribute("data-liked","true"),await f(a(y)),s.setAttribute("data-liked","false")),s.setAttribute("data-tapTime",p)};return{init:()=>{r=new Map,i=B("likes")},love:f,tapTap:c,getButtonLike:a,addListener:s=>{let p=new AbortController,b=document.getElementById(`body-content-${s}`);b.addEventListener("touchend",()=>c(b),{signal:p.signal}),r.set(s,p)},removeListener:s=>{let p=r.get(s);p&&(p.abort(),r.delete(s))}}})();var J=(()=>{let i=10,r=0,f=0,a=null,c=null,u=null,h=null,E=null,s=H=>{i=Number(H)},p=()=>i,b=()=>r,y=()=>f,m=()=>c.classList.contains("disabled")?null:c.classList.add("disabled"),n=()=>c.classList.contains("disabled")?c.classList.remove("disabled"):null,l=()=>u.classList.contains("disabled")?null:u.classList.add("disabled"),k=()=>u.classList.contains("disabled")?u.classList.remove("disabled"):null,T=H=>{l(),m();let d=g.disableButton(H,g.loader.replace("ms-0 me-1","mx-1"),!0),o=()=>{E.addEventListener("comment.done",()=>d.restore(),{once:!0}),E.addEventListener("comment.result",()=>E.scrollIntoView(),{once:!0}),E.dispatchEvent(new Event("comment.show"))};return{next:()=>{r+=i,H.innerHTML="Next"+H.innerHTML,o()},prev:()=>{r-=i,H.innerHTML=H.innerHTML+"Prev",o()}}};return{init:()=>{h=document.getElementById("pagination"),h.innerHTML=`
        <ul class="pagination mb-2 shadow-sm rounded-4">
            <li class="page-item disabled" id="previous">
                <button class="page-link rounded-start-4" onclick="undangan.comment.pagination.previous(this)" data-offline-disabled="false">
                    <i class="fa-solid fa-circle-left me-1"></i>Prev
                </button>
            </li>
            <li class="page-item disabled">
                <span class="page-link text-theme-auto" id="page"></span>
            </li>
            <li class="page-item" id="next">
                <button class="page-link rounded-end-4" onclick="undangan.comment.pagination.next(this)" data-offline-disabled="false">
                    Next<i class="fa-solid fa-circle-right ms-1"></i>
                </button>
            </li>
        </ul>`,E=document.getElementById("comments"),a=document.getElementById("page"),c=document.getElementById("previous"),u=document.getElementById("next")},setPer:s,getPer:p,getNext:b,reset:()=>r===0?!1:(r=0,l(),m(),!0),setTotal:H=>{if(f=Number(H),f<=i&&r===0){h.classList.add("d-none");return}let d=r/i+1,o=Math.ceil(f/i);if(a.innerText=`${d} / ${o}`,r>0&&n(),d>=o){l();return}k(),h.classList.contains("d-none")&&h.classList.remove("d-none")},geTotal:y,previous:H=>T(H).prev(),next:H=>T(H).next()}})();var ie=(()=>{let i=null,r=null,f=null,a=null,c=null,u=[],h=()=>`<div class="text-center p-4 mx-0 mt-0 mb-3 bg-theme-auto rounded-4 shadow"><p class="fw-bold p-0 m-0" style="font-size: 0.95rem;">${W.on("id","\u{1F4E2} Yuk, share undangan ini biar makin rame komentarnya! \u{1F389}").on("en","\u{1F4E2} Let's share this invitation to get more comments! \u{1F389}").get()}</p></div>`,E=(d,o)=>{document.querySelector(`[data-button-action="${d}"]`).childNodes.forEach(w=>{w.disabled=o})},s=d=>{E(d,!1),document.getElementById(`inner-${d}`).remove()},p=d=>{let o=d.getAttribute("data-uuids").split(","),w=d.getAttribute("data-show")==="true",t=d.getAttribute("data-uuid");w?(d.setAttribute("data-show","false"),d.innerText=`Show replies (${o.length})`,a.set("show",a.get("show").filter(v=>v!==t))):(d.setAttribute("data-show","true"),d.innerText="Hide replies",a.set("show",a.get("show").concat([t])));for(let v of o){a.set("hidden",a.get("hidden").map(I=>(I.uuid===v&&(I.show=!w),I)));let L=document.getElementById(v).classList;w?L.add("d-none"):L.remove("d-none")}},b=(d,o)=>{let w=document.getElementById(`content-${o}`),t=g.base64Decode(w.getAttribute("data-comment")),v=d.getAttribute("data-show")==="false";g.safeInnerHTML(w,v?t:t.slice(0,V.maxCommentLength)+"..."),d.innerText=v?"Sebagian":"Selengkapnya",d.setAttribute("data-show",v?"true":"false")},y=async d=>{if(!P.isAdmin()||(d.comments&&await Promise.all(d.comments.map(w=>y(w))),d.ip===void 0||d.user_agent===void 0||d.is_admin))return;let o=(w,t,v)=>{g.safeInnerHTML(document.getElementById(`ip-${g.escapeHtml(w)}`),`<i class="fa-solid fa-location-dot me-1"></i>${g.escapeHtml(t)} <strong>${g.escapeHtml(v)}</strong>`)};if(f.has(d.ip)){o(d.uuid,d.ip,f.get(d.ip));return}await z(K,`https://freeipapi.com/api/json/${d.ip}`).default(Q).then(w=>w.json()).then(w=>{let t=w.cityName+" - "+w.regionName;w.cityName==="-"&&w.regionName==="-"&&(t="localhost"),f.set(d.ip,t),o(d.uuid,d.ip,t)}).catch(w=>o(d.uuid,d.ip,w.message))},m=(d,o=[])=>(d.forEach(w=>{o.find(t=>t.uuid===w.uuid)||o.push(U.commentShowMore(w.uuid)),w.comments&&w.comments.length>0&&m(w.comments,o)}),o),n=()=>{for(let d of u)X.removeListener(d);return c.getAttribute("data-loading")==="false"&&(c.setAttribute("data-loading","true"),c.innerHTML=V.renderLoading().repeat(J.getPer())),z(K,`/api/v2/comment?per=${J.getPer()}&next=${J.getNext()}&lang=${W.getLanguage()}`).token(P.getToken()).send(U.getCommentsResponseV2).then(async d=>{c.setAttribute("data-loading","false");for(let w of u)await M.remove(w);if(d.data.lists.length===0)return c.innerHTML=h(),d;u=m(d.data.lists).map(w=>w.uuid),a.set("hidden",m(d.data.lists,a.get("hidden")));let o=await V.renderContentMany(d.data.lists);d.data.lists.length<J.getPer()&&(o+=h()),g.safeInnerHTML(c,o);for(let w of u)X.addListener(w);return d}).then(async d=>(c.dispatchEvent(new Event("comment.result")),d.data.lists.length>0&&await Promise.all(d.data.lists.map(o=>y(o))),J.setTotal(d.data.count),c.dispatchEvent(new Event("comment.done")),d))};return{gif:M,like:X,pagination:J,init:()=>{M.init(),X.init(),V.init(),J.init(),c=document.getElementById("comments"),c.addEventListener("comment.show",n),i=B("owns"),r=B("user"),f=B("tracker"),a=B("comment"),a.has("hidden")||a.set("hidden",[]),a.has("show")||a.set("show",[])},send:async d=>{let o=d.getAttribute("data-uuid"),w=document.getElementById("form-name"),t=w.value;if(P.isAdmin()&&(t=r.get("name")),t.length===0){alert("Name cannot be empty."),o&&w.scrollIntoView({block:"center"});return}let v=document.getElementById("form-presence");if(!o&&v&&v.value==="0"){alert("Please select your attendance status.");return}let L=M.isOpen(o||M.default),I=M.getResultId(o||M.default),R=M.buttonCancel(o);if(L&&!I){alert("Gif cannot be empty.");return}L&&I&&R.hide();let N=document.getElementById(`form-${o?`inner-${o}`:"comment"}`);if(!L&&N.value?.trim().length===0){alert("Comments cannot be empty.");return}!o&&w&&!P.isAdmin()&&(w.disabled=!0),!P.isAdmin()&&v&&v.value!=="0"&&(v.disabled=!0),N&&(N.disabled=!0);let F=document.querySelector(`[onclick="undangan.comment.cancel(this, '${o}')"]`);F&&(F.disabled=!0);let e=g.disableButton(d),$=v?v.value==="1":!0;if(!P.isAdmin()){let S=B("information");S.set("name",t),o||S.set("presence",$)}let x=await z(ee,`/api/comment?lang=${W.getLanguage()}`).token(P.getToken()).body(U.postCommentRequest(o,t,$,L?null:N.value,I)).send(U.getCommentResponse).then(S=>S,()=>null);if(w&&(w.disabled=!1),N&&(N.disabled=!1),F&&(F.disabled=!1),v&&(v.disabled=!1),L&&I&&R.show(),e.restore(),!(!x||x.code!==se)){if(i.set(x.data.uuid,x.data.own),N&&(N.value=null),L&&I&&R.click(),!o){if(J.reset()){await n(),c.scrollIntoView();return}J.setTotal(J.geTotal()+1),c.children.length===J.getPer()&&c.lastElementChild.remove(),x.data.is_admin=P.isAdmin();let S=await V.renderContentMany([x.data]);c.insertAdjacentHTML("afterbegin",S),c.scrollIntoView()}if(o){a.set("hidden",a.get("hidden").concat([U.commentShowMore(x.data.uuid,!0)])),a.set("show",a.get("show").concat([o])),s(o),x.data.is_admin=P.isAdmin(),document.getElementById(`reply-content-${o}`).insertAdjacentHTML("beforeend",await V.renderContentSingle(x.data));let S=document.getElementById(`button-${o}`).querySelector("a"),q=[x.data.uuid];S&&(S.getAttribute("data-show")==="false"&&p(S),S.remove());let O=document.createRange().createContextualFragment(V.renderReadMore(o,S?S.getAttribute("data-uuids").split(",").concat(q):q)),j=X.getButtonLike(o);j.parentNode.insertBefore(O,j)}X.addListener(x.data.uuid),u.push(x.data.uuid)}},edit:async d=>{let o=d.getAttribute("data-uuid");if(document.getElementById(`inner-${o}`))return;E(o,!0);let w=g.disableButton(d);await z(K,"/api/comment/"+o).token(P.getToken()).send(U.commentResponse).then(async t=>{if(t.code!==Z)return t;t.data.gif_url&&await M.remove(o);let v=document.getElementById(o).getAttribute("data-parent")==="true"&&!P.isAdmin();if(document.getElementById(`button-${o}`).insertAdjacentElement("afterend",V.renderEdit(o,t.data.presence,v,!!t.data.gif_url)),t.data.gif_url)return M.onOpen(o,()=>{M.removeGifSearch(o),M.removeButtonBack(o)}),M.open(o);let L=document.getElementById(`form-inner-${o}`);return L.value=t.data.comment,L.setAttribute("data-original",g.base64Encode(t.data.comment)),t}),w.restore(!0)},reply:async d=>{let o=d.getAttribute("data-uuid");if(document.getElementById(`inner-${o}`))return;E(o,!0);let w=g.disableButton(d);await M.remove(o),M.onOpen(o,()=>M.removeGifSearch(o)),w.restore(!0),document.getElementById(`button-${o}`).insertAdjacentElement("afterend",V.renderReply(o))},remove:async d=>{if(!confirm("Are you sure?"))return;let o=d.getAttribute("data-uuid");P.isAdmin()&&i.set(o,d.getAttribute("data-own")),E(o,!0);let w=g.disableButton(d),t=X.getButtonLike(o);if(t.disabled=!0,!await z(de,"/api/comment/"+i.get(o)).token(P.getToken()).send(U.statusResponse).then(L=>L.data.status,()=>!1)){w.restore(),t.disabled=!1;return}document.querySelectorAll('a[onclick="undangan.comment.showOrHide(this)"]').forEach(L=>{let I=L.getAttribute("data-uuids").split(",");if(I.find(R=>R===o)){let R=I.filter(N=>N!==o).join(",");R.length===0?L.remove():L.setAttribute("data-uuids",R)}}),i.unset(o),document.getElementById(o).remove(),c.children.length===0&&(c.innerHTML=h())},update:async d=>{let o=d.getAttribute("data-uuid"),w=!1,t=document.getElementById(`form-inner-presence-${o}`);t&&(t.disabled=!0,w=t.value==="1");let v=!1,L=document.getElementById(`badge-${o}`);L&&(v=L.getAttribute("data-is-presence")==="true");let I=M.isOpen(o),R=M.getResultId(o),N=M.buttonCancel(o);if(I&&!R){alert("Gif cannot be empty.");return}I&&R&&N.hide();let F=document.getElementById(`form-inner-${o}`);if(o&&!I&&g.base64Encode(F.value)===F.getAttribute("data-original")&&v===w){s(o);return}if(!I&&F.value?.trim().length===0){alert("Comments cannot be empty.");return}F&&(F.disabled=!0);let e=document.querySelector(`[onclick="undangan.comment.cancel(this, '${o}')"]`);e&&(e.disabled=!0);let $=g.disableButton(d),x=await z(le,`/api/comment/${i.get(o)}?lang=${W.getLanguage()}`).token(P.getToken()).body(U.updateCommentRequest(t?w:null,I?null:F.value,R)).send(U.statusResponse).then(S=>S.data.status,()=>!1);if(F&&(F.disabled=!1),e&&(e.disabled=!1),t&&(t.disabled=!1),$.restore(),I&&R&&N.show(),!!x){if(I&&R&&(document.getElementById(`img-gif-${o}`).src=document.getElementById(`gif-result-${o}`)?.querySelector("img").src,N.click()),s(o),!I){let S=document.querySelector(`[onclick="undangan.comment.showMore(this, '${o}')"]`),q=V.convertMarkdownToHTML(g.escapeHtml(F.value)),O=document.getElementById(`content-${o}`);q.length>V.maxCommentLength?(g.safeInnerHTML(O,S?.getAttribute("data-show")==="false"?q.slice(0,V.maxCommentLength)+"...":q),O.setAttribute("data-comment",g.base64Encode(q)),S?.classList.replace("d-none","d-block")):(g.safeInnerHTML(O,q),O.removeAttribute("data-comment"),S?.classList.replace("d-block","d-none"))}t&&(document.getElementById("form-presence").value=w?"1":"2",B("information").set("presence",w)),!(!t||!L)&&(L.classList.toggle("fa-circle-xmark",!w),L.classList.toggle("text-danger",!w),L.classList.toggle("fa-circle-check",w),L.classList.toggle("text-success",w))}},cancel:async(d,o)=>{let w=document.getElementById(`form-inner-presence-${o}`),t=w?w.value==="1":!1,v=document.getElementById(`badge-${o}`),L=v&&i.has(o)&&w?v.getAttribute("data-is-presence")==="true":!1;if(g.disableButton(d),M.isOpen(o)&&(!M.getResultId(o)&&L===t||confirm("Are you sure?"))){await M.remove(o),s(o);return}let I=document.getElementById(`form-inner-${o}`);(I.value.length===0||g.base64Encode(I.value)===I.getAttribute("data-original")&&L===t||confirm("Are you sure?"))&&s(o)},show:n,showMore:b,showOrHide:p}})();var be=(()=>{let i=null,r=()=>{let n=document.getElementById("count-down")?.getAttribute("data-time")?.replace(" ","T");if(!n){alert("Invalid countdown date.");return}let l=new Date(n).getTime(),k=()=>{let T=Math.abs(l-Date.now());document.getElementById("day").innerText=Math.floor(T/(1e3*60*60*24)).toString(),document.getElementById("hour").innerText=Math.floor(T%(1e3*60*60*24)/(1e3*60*60)).toString(),document.getElementById("minute").innerText=Math.floor(T%(1e3*60*60)/(1e3*60)).toString(),document.getElementById("second").innerText=Math.floor(T%(1e3*60)/1e3).toString(),g.timeOut(k,1e3-Date.now()%1e3)};requestAnimationFrame(k)},f=()=>{let n=window.location.search.split("to="),l=null;if(n.length>1&&n[1].length>=1&&(l=window.decodeURIComponent(n[1])),l){let T=document.getElementById("guest-name"),A=document.createElement("div");A.classList.add("m-2");let C=`<small class="mt-0 mb-1 mx-0 p-0">${g.escapeHtml(T?.getAttribute("data-message"))}</small><p class="m-0 p-0" style="font-size: 1.5rem">${g.escapeHtml(l)}</p>`;g.safeInnerHTML(A,C),T?.appendChild(A)}let k=document.getElementById("form-name");k&&(k.value=i.get("name")??l)},a=async()=>{let n=0,l=0,k=6e3,T=document.querySelectorAll(".slide-desktop");for(let[D,H]of T.entries())if(D===n){H.classList.add("slide-desktop-active"),await g.changeOpacity(H,!0);break}let A=async()=>{await g.changeOpacity(T[n],!1),T[n].classList.remove("slide-desktop-active"),n=(n+1)%T.length,T[n].classList.add("slide-desktop-active"),await g.changeOpacity(T[n],!0)},C=async D=>{D-l>=k&&(l=D,await A()),requestAnimationFrame(C)};g.timeOut(C,k)},c=n=>{n.disabled=!0,document.body.scrollIntoView({behavior:"instant"}),document.dispatchEvent(new Event("undangan.open")),oe.isAutoMode()&&(document.getElementById("button-theme").style.display="block"),a(),ae.play(),oe.spyTop(),ge(),g.timeOut(pe,1500),g.changeOpacity(document.getElementById("welcome"),!1).then(l=>l.remove())},u=n=>{let l=document.getElementById("show-modal-image");l.src=n.src,l.width=n.width,l.height=n.height,me.modal("modal-image").show()},h=()=>i.set("info",!0),E=()=>{document.querySelectorAll(".font-arabic").forEach(n=>{n.innerHTML=String(n.innerHTML).normalize("NFC")})},s=()=>{document.querySelectorAll("svg").forEach(n=>{g.timeOut(()=>n.classList.add(n.getAttribute("data-class")),parseInt(n.getAttribute("data-time")))})},p=()=>{let n=T=>new Date(T+":00Z").toISOString().replace(/[-:]/g,"").split(".").shift(),l=new URL("https://calendar.google.com/calendar/render"),k={action:"TEMPLATE",text:"The Wedding of Asrinda and Obi",dates:`${n("2025-05-10 11:00")}/${n("2025-05-10 12:00")}`,details:"Tanpa mengurangi rasa hormat, kami mengundang Anda untuk berkenan menghadiri acara pernikahan kami. Terima kasih atas perhatian dan doa restu Anda, yang menjadi kebahagiaan serta kehormatan besar bagi kami.",location:"https://maps.app.goo.gl/ZEhVYzUVTyqaKx2r9",ctz:"Asia/Jakarta"};Object.entries(k).forEach(([T,A])=>l.searchParams.set(T,A)),document.querySelector("#home button")?.addEventListener("click",()=>window.open(l,"_blank"))},b=async()=>{s(),r(),f(),E(),p(),document.getElementById("root").style.opacity="1",i.has("presence")&&(document.getElementById("form-presence").value=i.get("presence")?"1":"2"),i.get("info")&&document.getElementById("information")?.remove(),window.AOS.init(),document.body.scrollIntoView({behavior:"instant"}),await g.changeOpacity(document.getElementById("welcome"),!0),await g.changeOpacity(document.getElementById("loading"),!1).then(n=>n.remove())},y=()=>{W.init(),ue.init(),_.init(),i=B("information");let n=document.body.getAttribute("data-key");if(document.addEventListener("progress.done",()=>b()),document.addEventListener("hide.bs.modal",()=>document.activeElement?.blur()),(!n||n.length<=0)&&(_.add(),re.init().load(),ae.init(),document.getElementById("comment")?.remove(),document.querySelector('a.nav-link[href="#comment"]')?.closest("li.nav-item")?.remove()),n&&n.length>0){_.add(),_.add(),_.add();let l=re.init();l.hasDataSrc()||l.load();let k=new URLSearchParams(window.location.search);P.setToken(k.get("k")??n),window.addEventListener("load",()=>P.guest().then(()=>{_.complete("config"),l.hasDataSrc()&&l.load(),ae.init(),ie.init(),ie.show().then(()=>_.complete("comment")).catch(()=>_.invalid("comment"))}).catch(()=>_.invalid("config")))}};return{init:()=>(oe.init(),P.init(),P.isAdmin()&&(B("user").clear(),B("owns").clear(),B("likes").clear(),B("session").clear(),B("comment").clear(),B("tracker").clear()),window.addEventListener("DOMContentLoaded",y),{util:g,theme:oe,comment:ie,guest:{open:c,modal:u,closeInformation:h}})}})();(i=>{i.undangan=be.init()})(window);})();
